<!DOCTYPE html>
<html lang="en" xmlns:th = "http://www.thymeleaf.org" xmlns:layout="http://ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/admin.html"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
>
    <div class="col-9" layout:fragment="site_content">
        <div class="row mt-5">
            <div class="col-6 offset-3">
                <form th:action="@{'/edit_user'}" method="post">
                    <input type="hidden" name="id" th:value="${user.getId()}">
                    <div class="form-group">
                        <div class="form-group">
                            <label th:text="#{label.email}"></label>
                            <input type="email" name="user_email" class="form-control" th:value="${user.getEmail()}" readonly>
                        </div>
                        <div class="form-group">
                            <label th:text="#{label.FullName}">
                            </label>
                            <textarea name="user_name" class="form-control" th:text="${user.getFullName()}"></textarea>
                        </div>
                        <div class="form-group">
                            <label th:text="#{label.password}">
                            </label>
                            <input type="password" name="user_password" class="form-control" th:value="${user.getPassword()}">
                        </div>
                        <button  class="btn btn-success" name="btn" value="update" th:text="#{label.edit}"></button>
                        <button  class="btn btn-danger" name="btn" value="delete" th:text="#{button.delete}"></button>
                    </div>
                </form>
            </div>
        </div>
        <div class="row mt-5" sec:authorize="hasRole('ROLE_ADMIN')" id="rolesDiv">
            <div class="col-6 offset-3">
                <h2>Roles:</h2>
                <table class="table table-striped">
                    <tbody>
                        <tr th:each="c,iStat:${roles}">
                            <form th:action="@{'/set_role'}" method="post">
                                <input type="hidden" th:value="${user.getId()}" name="user_id">
                                <input type="hidden" th:value="${c.getId()}" name="role_id">
                                <td th:text="${c.getRole()}"></td>
                                <td width="10%">
                                    <button class="btn btn-success btn-sm" name="btn" value="set" th:if="${!user.getRoles().containsAll(roles.get(iStat.index))}">+</button>
                                    <button class="btn btn-danger btn-sm" name="btn" value="unset" th:if="${user.getRoles().containsAll(roles.get(iStat.index))}">-</button>
                                </td>
                            </form>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</html>